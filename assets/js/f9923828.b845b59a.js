"use strict";(self.webpackChunklamby=self.webpackChunklamby||[]).push([[5220],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>b});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=o.createContext({}),u=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=u(e.components);return o.createElement(l.Provider,{value:n},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=u(t),d=a,b=m["".concat(l,".").concat(d)]||m[d]||p[d]||r;return t?o.createElement(b,i(i({ref:n},c),{},{components:t})):o.createElement(b,i({ref:n},c))}));function b(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[m]="string"==typeof e?e:a,i[1]=s;for(var u=2;u<r;u++)i[u]=t[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6520:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>u,toc:()=>m});var o=t(7462),a=(t(7294),t(3905)),r=t(941),i=t(4996);const s={id:"running-tasks",title:"Running Tasks & Console",toc_max_heading_level:3},l=void 0,u={unversionedId:"running-tasks",id:"running-tasks",title:"Running Tasks & Console",description:"It can be common for Rails engineers to fire up the Rails console for some quick debugging or to run code like a Rake task. That said, console'ing into a Lambda function (typically done via SSH) is not possible and requires an event-driven & stateless solution. For this, we have the Lambda Console tool.",source:"@site/docs/running-tasks.mdx",sourceDirName:".",slug:"/running-tasks",permalink:"/docs/running-tasks",draft:!1,editUrl:"https://github.com/rails-lambda/lamby-site/tree/master/docs/running-tasks.mdx",tags:[],version:"current",frontMatter:{id:"running-tasks",title:"Running Tasks & Console",toc_max_heading_level:3},sidebar:"docsSidebar",previous:{title:"ActiveJob & Background Processing",permalink:"/docs/activejob"},next:{title:"Custom Domain Names",permalink:"/docs/custom-domain"}},c={},m=[{value:"Common Considerations",id:"common-considerations",level:2},{value:"Function Timeout",id:"function-timeout",level:3},{value:"IAM Security &amp; Permissions",id:"iam-security--permissions",level:3},{value:"Customizing Runner Patterns",id:"customizing-runner-patterns",level:3}],p={toc:m};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"It can be common for Rails engineers to fire up the ",(0,a.kt)("a",{parentName:"p",href:"https://guides.rubyonrails.org/command_line.html#bin-rails-console"},"Rails console")," for some quick debugging or to run code like a Rake task. That said, console'ing into a Lambda function (typically done via SSH) is not possible and requires an event-driven & stateless solution. For this, we have the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console"},"Lambda Console")," tool."),(0,a.kt)("a",{href:"https://github.com/rails-lambda/lambda-console"},(0,a.kt)(r.Z,{alt:"Lamby: Simple Rails & AWS Lambda Integration using Rack",sources:{light:(0,i.Z)("/img/docs/lambda-console-cli-light.png"),dark:(0,i.Z)("/img/docs/lambda-console-cli-dark.png")},mdxType:"ThemedImage"})),(0,a.kt)("p",null,"\ud83d\udc81\u200d\u2642\ufe0f ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console"},"https://github.com/rails-lambda/lambda-console")),(0,a.kt)("p",null,"Lamby leverages the Lambda Console using our Ruby implementation of the spec via the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console-ruby"},"lambda-console-ruby")," gem. Here is a quick overview on how to use it for common Rails tasks. Please see the  ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console"},"Lambda Console")," project for complete documentation on the CLI installation and usage."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"To use the Lambda Console, please make sure you are using Lamby v5.0.0 or higher.")),(0,a.kt)("h2",{id:"common-considerations"},"Common Considerations"),(0,a.kt)("p",null,"Here are some common considerations when using the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console"},"Lambda Console")," to run tasks or interactive commands."),(0,a.kt)("h3",{id:"function-timeout"},"Function Timeout"),(0,a.kt)("p",null,"Each ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"interact")," event sent will need to respond within your function's timeout. Since HTTP interactions via most AWS services are limited to 30s, so too is your function's default timeout set to that. If your task takes longer than this, consider temporarily increasing the value in your Cloud Formation template or duplicating your function (copy paste) to a new Lambda Function resource dedicated for running console tasks. A Lambda function can have a maximum of 15m execution time. Just remember that API Gateway integration will always be limited to 30s under the function's timeout. So these timeouts can operate independently."),(0,a.kt)("h3",{id:"iam-security--permissions"},"IAM Security & Permissions"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rails-lambda/lambda-console"},"Lambda Console")," leverages AWS SDKs to send invoke events to your function(s). This means you are in full control of the security of your function and whom can invoke it with the following IAM actions for your user or role:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"lambda:ListFunctions")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"lambda:InvokeFunction"))),(0,a.kt)("h3",{id:"customizing-runner-patterns"},"Customizing Runner Patterns"),(0,a.kt)("p",null,"By default, Lamby v5 and higher allows any command to be run. If you want to enforce which commands can be run at the application layer, please use the Lamby config in your ",(0,a.kt)("inlineCode",{parentName:"p"},"production.rb")," environment file. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"config.lamby.runner_patterns.clear\nconfig.lamby.runner_patterns.push %r{\\A/bin/foo.*}\n")),(0,a.kt)("p",null,"Here are are clearning/removing the deafault expression pattern of ",(0,a.kt)("inlineCode",{parentName:"p"},"/.*/")," in favor of one that allows any ",(0,a.kt)("inlineCode",{parentName:"p"},"/bin/foo")," command to be run."))}d.isMDXComponent=!0}}]);