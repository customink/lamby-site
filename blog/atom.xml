<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://technology.customink.com/blog</id>
    <title>Lamby - Simple Rails &amp; AWS Lambda Integration using Rack Blog</title>
    <updated>2022-12-19T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://technology.customink.com/blog"/>
    <subtitle>Lamby - Simple Rails &amp; AWS Lambda Integration using Rack Blog</subtitle>
    <icon>https://technology.customink.com/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Welcome Lamby v4!]]></title>
        <id>welcome-to-lamby-v4</id>
        <link href="https://technology.customink.com/blog/welcome-to-lamby-v4"/>
        <updated>2022-12-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[I am incredibly happy to announcy Lamby v4 and a major update to our documentation website. Huge shout out to Docusaurus which has made in my opinion the best content-driven static site generator for open-source projects like our Lamby community.]]></summary>
        <content type="html"><![CDATA[<p>I am incredibly happy to announcy Lamby v4 and a major update to our documentation website. Huge shout out to <a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer">Docusaurus</a> which has made in my opinion the best content-driven static site generator for open-source projects like our Lamby community.</p><img src="/img/lamby-rails-containers.jpg" alt="Lamby: Simple Rails &amp; AWS Lambda Integration using Rack" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/lamby-rails-dark.jpg" alt="Lamby: Simple Rails &amp; AWS Lambda Integration using Rack" class="themedImage_ToTc themedImage--dark_i4oU"><p>So what is new and will v4 break anything? Lots! Mostly new ways of thinking around the same basic architecture. Nothing should break either. Lamby v4's semver change is mostly marketing driven. Here is a short list of what is new.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updated-starter">Updated Starter<a class="hash-link" href="#updated-starter" title="Direct link to heading">​</a></h2><p>Want to see all this new stuff in action? Use our <a href="/docs/quick-start">Quick Start</a> guide to deploy a new Rails application to AWS Lambda in 5min ⏱️.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bring-your-own-containers">Bring Your Own Containers<a class="hash-link" href="#bring-your-own-containers" title="Direct link to heading">​</a></h2><p>Lamby still works with the Zip packaing format, but all documentation on how to use it has been removed. Containers are here to stay and their value goes way past a simple packaging format. </p><p>We now encourage bringing your own containers by using Lambda's Runtime Interface Client (RIC). The RIC allows us to use Docker's <code>CMD</code> to load Rails and invoke a function. In this case we are loading our Rails application through its config/environment.rb file (.rb extension is implied) and once that is done, calling the new <code>Lamby.cmd</code> as the Lambda handler. No more <code>app.rb</code>
file needed!</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Dockerfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ruby:3.2-bullseye</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> gem install </span><span class="token instruction string" style="color:#e3116c">'aws_lambda_ric'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">ENTRYPOINT</span><span class="token instruction"> [ </span><span class="token instruction string" style="color:#e3116c">"/usr/local/bundle/bin/aws_lambda_ric"</span><span class="token instruction"> ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">CMD</span><span class="token instruction"> [</span><span class="token instruction string" style="color:#e3116c">"config/environment.Lamby.cmd"</span><span class="token instruction">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="secrets-with-crypteia">Secrets with Crypteia<a class="hash-link" href="#secrets-with-crypteia" title="Direct link to heading">​</a></h2><p>The <a href="https://github.com/customink/crypteia" target="_blank" rel="noopener noreferrer">Crypteia</a> package is Rust Lambda Extension for any Runtime/Container to preload SSM Parameters as secure environment variables. It takes advantages of <code>LD_PRELOAD</code> to seamlessly fetch values from SSM when a process starts and then injects them as natively accesible Ruby <code>ENV</code> variables. Our <a href="/docs/quick-start">Quick Start</a> guide's cookiecutter includes Crypteia already for you via a Docker <code>COPY</code> command into the Lambda Extension <code>/opt</code> directory.</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Dockerfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ruby:3.2-bullseye</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#36acaa">--from</span><span class="token instruction options punctuation" style="color:#393A34">=</span><span class="token instruction options string" style="color:#e3116c">ghcr.io/customink/crypteia-extension-debian:latest</span><span class="token instruction"> /opt /opt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Usage is simply done by adding variables to your SAM template and accessing the values fetched from SSM like any other environment variable. Please read the Crypteia's <a href="https://github.com/customink/crypteia" target="_blank" rel="noopener noreferrer">documentation</a> for full details.</p><div class="language-title=&quot;template.yaml&quot; codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-title=&quot;template.yaml&quot; codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Globals:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Variables:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      SECRET: x-crypteia-ssm:/myapp/SECRET</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">ENV</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">'SECRET'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 1A2B3C4D5E6F</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-containers">Development Containers<a class="hash-link" href="#development-containers" title="Direct link to heading">​</a></h2><p>Described in the <a href="/docs/quick-start">Quick Start</a> guide, our Lamby starter makes use of the <a href="https://containers.dev" target="_blank" rel="noopener noreferrer">Development Container</a> specification via a <a href="https://github.com/customink/lamby-cookiecutter/tree/master/%7B%7Bcookiecutter.project_name%7D%7D/.devcontainer" target="_blank" rel="noopener noreferrer"><code>.devcontainer</code></a> directory. Commonly used with Codespaces, dev containers can be used locally with any editor. </p><p>Our dev container's <code>Dockerfile</code> uses the same base image as the one at the root of your project. This helps ensure your development experience, like installing system dependencies and Ruby gems with native extensions, aligns with the same process as your production image.</p><p>We also leverage the devcontainer's <code>dockerComposeFile</code> capability to include a MySQL service as well. The Lamby starter also includes a range of <a href="https://containers.dev/features" target="_blank" rel="noopener noreferrer">devcontainer features</a> which are installed within the Ubuntu development image. For example, Node, Docker in Docker, SSH, and the AWS CLI &amp; SAM CLI.</p>]]></content>
        <author>
            <name>Ken Collins</name>
            <uri>https://dev.to/metaskills</uri>
        </author>
        <category label="rails" term="rails"/>
        <category label="lambda" term="lambda"/>
        <category label="containers" term="containers"/>
    </entry>
</feed>